import{J as T,af as w,aj as _,o as h,P as Q,Q as V,R as s,S as l,T as d,a0 as U,U as a,A as y,V as u,K as x,N as C,M as m}from"./index.d3ad043f.js";import{Q as S}from"./QTd.1a8fab95.js";import{C as v,Q as F,a as B,b as N,_ as A}from"./ConfirmDelete.041abbd4.js";import{a as D,b as k,Q as q}from"./QPage.7bf2ba30.js";import{Q as E,h as P}from"./format.59a25017.js";import{Q as p}from"./QInput.7e27db63.js";import{Q as L}from"./QCardActions.79877e99.js";import{d as b}from"./helper.c15e2c11.js";import"./use-quasar.f628857e.js";import"./use-transition.5f5ddb9c.js";const o=T({list:[],pagination:{rowsPerPage:15,rowsNumber:0,page:0,descending:!0},columns:R(),getList:$,showAddEditForm:!1,form:z(),reset:j,add:M,loadingTable:!1,loadingSubmitButton:!1});async function M(){var n,r,t;o.loadingTable=!0,o.loadingSubmitButton=!0;try{const e=await w.request({url:o.form._id?`users/${o.form._id}`:"users",method:o.form._id?"patch":"post",data:{...o.form},params:{...o.pagination}});o.list=e.data.data,o.pagination.rowsNumber=e.data.total,o.showAddEditForm=!1}catch(e){console.error(e.message),_.create((t=(r=(n=e.response)==null?void 0:n.data)==null?void 0:r.message)!=null?t:e==null?void 0:e.message)}o.loadingTable=!1,o.loadingSubmitButton=!1}async function $(n){var r,t,e,c,f,g;o.loadingTable=!0;try{n&&(o.pagination=n.pagination);const i=await w.get("users",{params:o.pagination});o.list=(t=(r=i.data)==null?void 0:r.data)!=null?t:[],o.pagination.rowsNumber=(e=i.data)==null?void 0:e.total}catch(i){console.error(i.message),_.create((g=(f=(c=i.response)==null?void 0:c.data)==null?void 0:f.message)!=null?g:i==null?void 0:i.message)}o.loadingTable=!1}function R(){return[{name:"name",label:"name",align:"left",field:n=>n.name},{name:"phone",label:"phone",align:"left",field:n=>n.phone},{name:"actions",label:""}]}function z(){return{id:null,name:"",phone:"",corp:null,designations:["Member"]}}function j(){o.form={id:null,name:"",phone:"",corp:null,designations:["Member"]}}const H={class:"col"},I={class:"col-auto"},J={__name:"UserForm",setup(n){return h(()=>{b.getList()}),(r,t)=>(Q(),V(B,{"no-backdrop-dismiss":"",modelValue:a(o).showAddEditForm,"onUpdate:modelValue":t[4]||(t[4]=e=>a(o).showAddEditForm=e)},{default:s(()=>[l(D,{style:{"min-width":"min(400px, 100vw)"}},{default:s(()=>[l(E,{class:"bg-primary text-white"},{default:s(()=>[l(P,{class:"row"},{default:s(()=>{var e;return[d("div",H,U((e=a(o).form)!=null&&e._id?"Edit":"Add")+" User",1),d("div",I,[y(l(u,{round:"",flat:"",icon:"close"},null,512),[[v]])])]}),_:1})]),_:1}),l(k,null,{default:s(()=>[l(L,{onSubmit:a(o).add},{default:s(()=>[l(p,{outlined:"",autofocus:"",modelValue:a(o).form.name,"onUpdate:modelValue":t[0]||(t[0]=e=>a(o).form.name=e),type:"text",label:"Name",rules:[e=>!!e||"Name is required"]},null,8,["modelValue","rules"]),l(p,{outlined:"",modelValue:a(o).form.phone,"onUpdate:modelValue":t[1]||(t[1]=e=>a(o).form.phone=e),type:"text",label:"Phone",hint:""},null,8,["modelValue"]),l(p,{outlined:"",modelValue:a(o).form.bial,"onUpdate:modelValue":t[2]||(t[2]=e=>a(o).form.bial=e),type:"text",label:"Bial",hint:""},null,8,["modelValue"]),l(F,{outlined:"","emit-value":"","map-options":"",multiple:"",modelValue:a(o).form.designations,"onUpdate:modelValue":t[3]||(t[3]=e=>a(o).form.designations=e),options:a(b).list,label:"Designation",hint:"","option-label":"name","option-value":"_id"},null,8,["modelValue","options"]),l(u,{loading:a(o).loadingSubmitButton,type:"submit",color:"primary",class:"full-width q-mt-md",label:"Submit"},null,8,["loading"])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},K={class:"full-width row"},G=d("div",{class:"col"},null,-1),O={class:"col-auto"},W={class:"row q-col-gutter-sm",style:{"min-width":"100px"}},X={class:"col-auto"},Y={class:"col-auto"},mo={__name:"UsersPage",setup(n){return x(()=>{o.list=[]}),C(()=>{o.list=[]}),h(async()=>{await o.getList()}),(r,t)=>(Q(),V(q,{class:"",padding:""},{default:s(()=>[l(N,{loading:a(o).loadingTable,pagination:a(o).pagination,"onUpdate:pagination":t[1]||(t[1]=e=>a(o).pagination=e),onRequest:a(o).getList,square:"",flat:"",bordered:"",rows:a(o).list,columns:a(o).columns,class:"full-width"},{top:s(()=>[d("div",K,[G,d("div",O,[l(u,{rounded:"",color:"accent",icon:"add",title:"Add User",onClick:t[0]||(t[0]=()=>{a(o).reset(),a(o).showAddEditForm=!0})})])])]),"body-cell-actions":s(e=>[l(S,{"auto-width":"",props:e},{default:s(()=>[d("div",W,[d("div",X,[y(l(u,{round:"",onClick:()=>{a(o).form={...e.row},a(o).showAddEditForm=!0},color:"accent",size:"12px",icon:"edit"},null,8,["onClick"]),[[v]])]),d("div",Y,[l(u,{round:"",onClick:()=>{a(m).tempData={...e.row},a(m).tempData.title=e.row.name,a(m).tempData.endpoint="users",a(m).showConfirmDeleteDialog=!0,a(m).pagination={...a(o).pagination}},color:"negative",size:"12px",icon:"delete"},null,8,["onClick"])])])]),_:2},1032,["props"])]),_:1},8,["loading","pagination","onRequest","rows","columns"]),l(J),l(A,{onUpdateTable:t[2]||(t[2]=e=>{a(o).list=e.data,a(o).pagination.rowsNumber=e.total})})]),_:1}))}};export{mo as default};
