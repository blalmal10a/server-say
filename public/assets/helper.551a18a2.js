import{d}from"./date.4199c5fc.js";import{J as c,af as m,aj as u}from"./index.d3ad043f.js";const e=c({detail:{},createDialog:!1,selectedDate:void 0,showAddEditForm:!1,loadingTable:!1,loadingSubmitButton:!1,is_executive:!1,payment_status:"All",selectedTag:"Fellowship",list:[],users:[],all_members:[],selectedList:[],paid_list:[],pagination:{descending:!0,rowsPerPage:15,rowsNumber:0,page:0},columns:y(),form_columns:T(),form:w(),create:F,update:M,getList:_,reset:D,save:b,onSelectPaymentFilter:h,show:p,onBlurAmount:g,checkMonthExists:f});async function f(a,s){var t;try{e.loadingTable=!0,e.selectedDate=d.formatDate(new Date().setMonth(a,1),"YYYY-MM-DD");const{data:i}=await m.get(`faith-promises/check-month-exists?date=${e.selectedDate}`);s.push({name:"faith-promise-detail",params:{_id:i._id}});const o={params:{...i}};await e.show(o),e.createDialog=!1}catch(i){((t=i.response)==null?void 0:t.status)==404&&(e.createDialog=!1)}}async function g(a,s){var i;if(a.amount=="")return;const t={user_id:a._id,amount:a.amount,faith_promise_id:(i=s.params)==null?void 0:i._id};m.post("faith-promise-payments",t)}async function p(a,s){try{e.loadingTable=!0;const t=await m.get(`faith-promises/${a.params._id}`);e.detail=t.data,e.users=t.data.pending,e.paid_list=t.data.paid,e.loadingTable=!1,e.selectedDate=t.data.month}catch(t){e.loadingTable=!1,console.error(t.message)}}function h(a){a=="All"?e.users=[...e.all_members]:a=="Pending"?e.users=e.all_members.filter(s=>{if(s.amount<1)return s}):a=="Paid"&&(e.users=e.all_members.filter(s=>{if(s.amount>=1)return s}))}async function b(a,s,t){var i,o;try{let n=(o=a.params._id)!=null?o:(i=e.detail)==null?void 0:i._id;e.loadingSubmitButton=!0;const l=await m.patch(`faith-promises/${n}`);e.detail=l.data,e.loadingSubmitButton=!1}catch{e.loadingSubmitButton=!1}}async function _(a){var s,t,i,o,n,l;e.loadingTable=!0;try{a&&(e.pagination=a.pagination);const r=await m.get("faith-promises",{params:e.pagination});e.list=(t=(s=r.data)==null?void 0:s.data)!=null?t:[],e.pagination.rowsNumber=(i=r.data)==null?void 0:i.total}catch(r){console.error(r.message),u.create((l=(n=(o=r.response)==null?void 0:o.data)==null?void 0:n.message)!=null?l:r==null?void 0:r.message)}e.loadingTable=!1}function y(){return[{label:"Month",name:"month",align:"left",field:a=>d.formatDate(a.month,"MMMM, YYYY")},{label:"Amount",name:"amount",align:"left",field:a=>a.total_amount?`\u20B9${a.total_amount}`:"N/A"},{name:"actions",label:""}]}function T(){return[{label:"name",name:"name",align:"left",field:a=>{var s,t;return(t=a.name)!=null?t:(s=a.user)==null?void 0:s.name}},{label:"Amount",name:"amount"}]}function w(){return{id:null,name:"",phone:"",corp:null}}function D(){e.form={id:null,name:"",phone:"",corp:null}}async function F(a){var s,t,i,o,n;try{e.loadingTable=!0;const l=await m.get(`faith-promises/create?executive=${(s=a.query.executive)!=null?s:0}`);e.users=(t=l.data)!=null?t:[],e.all_members=[...l.data],e.is_executive=!!a.query.executive,e.loadingTable=!1}catch(l){e.loadingTable=!1,console.error(l.message),u.create((n=(o=(i=l.response)==null?void 0:i.data)==null?void 0:o.message)!=null?n:l==null?void 0:l.message)}}async function M(a){var s,t,i,o;try{e.loadingTable=!0;const n=await m.get(`faith-promises/${a}/edit`);e.users=(s=n.data.details)!=null?s:[],e.all_members=[...n.data.details],e.selectedDate=n.data.month,e.loadingTable=!1}catch(n){e.loadingTable=!1,console.error(n.message),u.create((o=(i=(t=n.response)==null?void 0:t.data)==null?void 0:i.message)!=null?o:n==null?void 0:n.message)}}export{e as f};
